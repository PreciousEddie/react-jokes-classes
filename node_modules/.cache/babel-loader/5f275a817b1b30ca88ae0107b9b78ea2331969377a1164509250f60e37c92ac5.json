{"ast":null,"code":"import _regeneratorRuntime from\"/home/eddie/Code/react-jokes-classes/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectDestructuringEmpty from\"/home/eddie/Code/react-jokes-classes/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js\";import _toConsumableArray from\"/home/eddie/Code/react-jokes-classes/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/home/eddie/Code/react-jokes-classes/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/home/eddie/Code/react-jokes-classes/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/eddie/Code/react-jokes-classes/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import Joke from\"./Joke\";import\"./JokeList.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function JokeList(_ref){var _ref$numJokesToGet=_ref.numJokesToGet,numJokesToGet=_ref$numJokesToGet===void 0?5:_ref$numJokesToGet;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),jokes=_useState2[0],setJokes=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];useEffect(function(){getJokes();},[]);function getJokes(){return _getJokes.apply(this,arguments);}function _getJokes(){_getJokes=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _jokes,seenJokes,res,joke;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_jokes=[];seenJokes=new Set();case 3:if(!(_jokes.length<numJokesToGet)){_context.next=11;break;}_context.next=6;return axios.get(\"https://icanhazdadjoke.com\",{headers:{Accept:\"application/json\"}});case 6:res=_context.sent;joke=Object.assign({},(_objectDestructuringEmpty(res.data),res.data));if(!seenJokes.has(joke.id)){seenJokes.add(joke.id);_jokes.push(_objectSpread(_objectSpread({},joke),{},{votes:0}));}else{console.log(\"duplicate found!\");}_context.next=3;break;case 11:setJokes(_jokes);setIsLoading(false);_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 18:case\"end\":return _context.stop();}},_callee,null,[[0,15]]);}));return _getJokes.apply(this,arguments);}function generateNewJokes(){setIsLoading(true);getJokes();}function vote(id,delta){setJokes(function(prevJokes){return prevJokes.map(function(j){return j.id===id?_objectSpread(_objectSpread({},j),{},{votes:j.votes+delta}):j;});});}var sortedJokes=_toConsumableArray(jokes).sort(function(a,b){return b.votes-a.votes;});if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-4x fa-spinner fa-spin\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"JokeList\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"JokeList-getmore\",onClick:generateNewJokes,children:\"Get New Jokes\"}),sortedJokes.map(function(j){return/*#__PURE__*/_jsx(Joke,{text:j.joke,id:j.id,votes:j.votes,vote:vote},j.id);})]});}export default JokeList;","map":{"version":3,"names":["React","useState","useEffect","axios","Joke","jsx","_jsx","jsxs","_jsxs","JokeList","_ref","_ref$numJokesToGet","numJokesToGet","_useState","_useState2","_slicedToArray","jokes","setJokes","_useState3","_useState4","isLoading","setIsLoading","getJokes","_getJokes","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_jokes","seenJokes","res","joke","wrap","_callee$","_context","prev","next","Set","length","get","headers","Accept","sent","Object","assign","_objectDestructuringEmpty","data","has","id","add","push","_objectSpread","votes","console","log","t0","error","stop","generateNewJokes","vote","delta","prevJokes","map","j","sortedJokes","_toConsumableArray","sort","a","b","className","children","onClick","text"],"sources":["/home/eddie/Code/react-jokes-classes/src/JokeList.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Joke from \"./Joke\";\nimport \"./JokeList.css\";\n\nfunction JokeList({ numJokesToGet = 5 }) {\n  const [jokes, setJokes] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  useEffect(() => {\n    getJokes();\n  }, []);\n  async function getJokes() {\n    try {\n      let jokes = [];\n      let seenJokes = new Set();\n      while (jokes.length < numJokesToGet) {\n        let res = await axios.get(\"https://icanhazdadjoke.com\", {\n          headers: { Accept: \"application/json\" }\n        });\n        let { ...joke } = res.data;\n\n        if (!seenJokes.has(joke.id)) {\n          seenJokes.add(joke.id);\n          jokes.push({ ...joke, votes: 0 });\n        } else {\n          console.log(\"duplicate found!\");\n        }\n      }\n      setJokes(jokes);\n      setIsLoading(false);\n    } catch (err) {\n      console.error(err);\n    }\n  }\n  function generateNewJokes() {\n    setIsLoading(true);\n    getJokes();\n  }\n  function vote(id, delta) {\n    setJokes(prevJokes =>\n      prevJokes.map(j => (j.id === id ? { ...j, votes: j.votes + delta } : j))\n    );\n  }\n  let sortedJokes = [...jokes].sort((a, b) => b.votes - a.votes);\n  if (isLoading) {\n    return (\n      <div className=\"loading\">\n        <i className=\"fas fa-4x fa-spinner fa-spin\" />\n      </div>\n    );\n  }\n  return (\n    <div className=\"JokeList\">\n      <button\n        className=\"JokeList-getmore\"\n        onClick={ generateNewJokes }\n      >\n        Get New Jokes\n      </button>\n      { sortedJokes.map(j => (\n        <Joke\n          text={ j.joke }\n          key={ j.id }\n          id={ j.id }\n          votes={ j.votes }\n          vote={ vote }\n        />\n      )) }\n    </div>\n  );\n}\n\nexport default JokeList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}